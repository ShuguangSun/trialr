<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clinical Trial Designs in 'RStan' • trialr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">trialr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/BEBOP.html">BEBOP in PePS2</a>
    </li>
    <li>
      <a href="articles/CRM-model-choice.html">Posterior model choice in CRM</a>
    </li>
    <li>
      <a href="articles/CRM-visualisation.html">Visualisation with CRM in `trialr`</a>
    </li>
    <li>
      <a href="articles/CRM.html">Continual Reassessment Method in `trialr`</a>
    </li>
    <li>
      <a href="articles/EffTox.html">EffTox in trialr</a>
    </li>
    <li>
      <a href="articles/HierarchicalBayesianResponse.html">Hierarchical Bayesian Model for Binary Responses</a>
    </li>
    <li>
      <a href="articles/trialr-overview.html">Overview of `trialr`</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brockk/trialr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    <div id="trialr---clinical-trial-designs-in-r-stan" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#trialr---clinical-trial-designs-in-r-stan" class="anchor"></a>trialr - Clinical Trial Designs in R &amp; Stan</h1></div>
<p>This R package implements clinical trial designs in R and RStan.</p>
<p>RStan is the R connector of the <a href="http://mc-stan.org/">Stan</a> project. Stan offers full Bayesian statistical inference so the designs implemented here tend to be Bayesian in nature. Furthermore, there is a preponderance of early-phase clinical trial designs because a) these are the designs that tend to use Bayesian methodology; and b) this is my research area.</p>
<p>Functions are provided to invoke a trial analysis on observed outcomes and perform simulations.</p>
<p>Trial designs currently implemented include:</p>
<ul>
<li>EffTox, by Thall &amp; Cook.</li>
<li>a Hierarchical Bayesian model for binary response outcomes, by Thall, Wathen, Bekele, Champlin, Baker &amp; Benjamin (2003)</li>
<li>Bayesian Evaluation of Bivariate Binary Outcomes with Predictive Information (BEBOP), by Brock et al.</li>
</ul>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<pre class="{r}"><code>library(trialr)</code></pre>
<div id="efftox-example" class="section level3">
<h3 class="hasAnchor">
<a href="#efftox-example" class="anchor"></a>EffTox example</h3>
<p>In a nutshell, Thall &amp; Cook’s EffTox is a dose-finding design that uses binary efficacy and toxicity outcomes to select a dose with a high utility score. Refer to <em>Dose-Finding Based on Efficacy-Toxicity Trade-Offs</em> (Thall &amp; Cook) and <em>Effective sample size for computing prior hyperparameters in Bayesian phase I-II dose-finding</em> (Thall, Herrick, Nguyen, Venier &amp; Norris).</p>
<p>Get parameters for EffTox demo scenario</p>
<pre class="{r}"><code>dat &lt;- efftox_parameters_demo()</code></pre>
<p>Add outcomes for 3 patients: patient 1, treated at dose 1, has neither efficacy nor toxicity; patient 2, treated at dose 2, has just efficacy; and patients 3, treated at dose 3, has both.</p>
<pre class="{r}"><code>dat$num_patients &lt;- 3
dat$eff &lt;- c(0, 1, 1)
dat$tox &lt;- c(0, 0, 1)
dat$doses &lt;- c(1, 2, 3)</code></pre>
<p>Invoke RStan posterior sampling on model and data. By installing <code>trialr</code>, the EffTox model is compiled on your system and made available for sampling via the <code>stanmodels</code> object.</p>
<pre class="{r}"><code>set.seed(123)
samp &lt;- rstan::sampling(stanmodels$EffTox, data = dat)
decision &lt;- efftox_process(dat, samp)
decision$recommended_dose  # 3 is the recommended dose-level
round(decision$utility, 2)  #  -0.63  0.04  0.22 -0.07 -0.21</code></pre>
<p>Doses 3 has the highest utility score. Sometimes, doses other than the maximal-utility dose will be recommended because of the dose-admissibility rules. See the papers for details.</p>
<p>Functions are provided to create useful plots. For instance, it is illuminating to plot the posterior means of the probabilities of efficacy and toxicity at each of the doses on the trade-off contours. The five doses are shown in red. Doses closer to the lower-right corner have higher utility.</p>
<pre class="{r}"><code><a href="reference/efftox_contour_plot.html">efftox_contour_plot(dat, prob_eff = decision$prob_eff, prob_tox = decision$prob_tox)
title('EffTox utility contours')</a></code></pre>
<p><em>plot not shown in CRAN version of README. View at <a href="https://github.com/brockk/trialr" class="uri">https://github.com/brockk/trialr</a> </em></p>
<p>Another way of viewing dose-utility is a density plot</p>
<p><code>efftox_utility_density_plot(samp, doses = 1:3) + ggtitle("EffTox dose utility densities")</code></p>
<p><em>plot not shown in CRAN version of README. View at <a href="https://github.com/brockk/trialr" class="uri">https://github.com/brockk/trialr</a> </em></p>
<p>From this plot, it is perhaps not obvious that dose 3 has higher expected utility than dose 2.</p>
</div>
</div>
<div id="install-trialr" class="section level2">
<h2 class="hasAnchor">
<a href="#install-trialr" class="anchor"></a>Install <code>trialr</code>
</h2>
<div id="latest-release" class="section level3">
<h3 class="hasAnchor">
<a href="#latest-release" class="anchor"></a>Latest Release</h3>
<p>To install the most recent release on CRAN, use</p>
<pre class="{r}"><code>install.packages("trialr")</code></pre>
</div>
<div id="development-version" class="section level3">
<h3 class="hasAnchor">
<a href="#development-version" class="anchor"></a>Development Version</h3>
<p>You can install straight from GitHub and get the most recent commits (i.e. between releases).</p>
<p>Install devtools if you do not already have it</p>
<pre class="{r}"><code>if (!require(devtools)) {
  install.packages("devtools")
}</code></pre>
<p>Then run</p>
<pre class="{r}"><code><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">devtools::install_github('brockk/trialr')</a></code></pre>
</div>
</div>
<div id="trouble-shooting" class="section level2">
<h2 class="hasAnchor">
<a href="#trouble-shooting" class="anchor"></a>Trouble-shooting</h2>
<p>The install process is sometimes a little tricky. <code>trialr</code> relies on Stan, so <code>rstan</code> must be installed succesfully first. RStan relies on a C++ compiler being installed, and the compiler used varies by platform. I give more detailed steps for Windows, Mac and Linux below.</p>
<div id="windows" class="section level3">
<h3 class="hasAnchor">
<a href="#windows" class="anchor"></a>Windows</h3>
<p>In my experience, the install sequence that works best is:</p>
<ol>
<li>Install <code>Rtools</code>, to get a C++ compiler</li>
<li>Install <code>rstan</code>
</li>
<li>Install <code>trialr</code>
</li>
</ol>
<div id="installing-rtools" class="section level4">
<h4 class="hasAnchor">
<a href="#installing-rtools" class="anchor"></a>Installing Rtools</h4>
<p>Visit <a href="https://cran.r-project.org/bin/windows/Rtools/" class="uri">https://cran.r-project.org/bin/windows/Rtools/</a> and install for your version of R. I always try to use the newest version of everything to maximise chances that bugs have been fixed.</p>
</div>
<div id="installing-rstan" class="section level4">
<h4 class="hasAnchor">
<a href="#installing-rstan" class="anchor"></a>Installing rstan</h4>
<p>This may be as simple as running</p>
<pre class="{r}"><code>install.packages("rstan")</code></pre>
<p>This should install the many requisites for RStan too. Requirements include <code>stantools</code> and <code>Rcpp</code>. If you encounter problems, you should visit the <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started">RStan quick start guide</a> and follow the instructions for your platform. Further help will be available at the RStan homepage at <a href="http://mc-stan.org/interfaces/rstan.html">mc-stan.org</a>.</p>
<p>Finally, install <code>trialr</code> using one of the methods described above.</p>
</div>
</div>
<div id="mac" class="section level3">
<h3 class="hasAnchor">
<a href="#mac" class="anchor"></a>Mac</h3>
<p>To compile C++ code on your Mac, you will need a toolchain. One way to do that is to install the XCode developer tools. Try running <code>gcc</code> on the command line. If developer tools are not installed, this command should start the process. You may need to agree to terms of use (also via the command line) before compiling is possible.</p>
<p>Once a C++ compiler is installed, follow the instructions above to install <code>rstan</code>.</p>
<p>And finally, install <code>trialr</code> as described above.</p>
</div>
<div id="linux" class="section level3">
<h3 class="hasAnchor">
<a href="#linux" class="anchor"></a>Linux</h3>
<p>Coming soon.</p>
</div>
</div>
<div id="extending-trialr-and-getting-in-touch" class="section level2">
<h2 class="hasAnchor">
<a href="#extending-trialr-and-getting-in-touch" class="anchor"></a>Extending trialr and getting in touch</h2>
<p>If there is a published Bayesian design you want implemented in Stan, get in touch. Contact @brockk on GitHub</p>
</div>
</div>
  </div>

  <div class="col-md-3" id="sidebar">
    <h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=trialr">https://​cran.r-project.org/​package=trialr</a>
</li>
<li>Browse source code at <br><a href="https://github.com/brockk/trialr">https://​github.com/​brockk/​trialr</a>
</li>
<li>Report a bug at <br><a href="https://github.com/brockk/trialr/issues">https://​github.com/​brockk/​trialr/​issues</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Kristian Brock <br><small class="roles"> Author, maintainer </small> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Kristian Brock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
