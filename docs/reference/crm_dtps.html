<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate dose-transition pathways for a CRM study — crm_dtps • trialr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Calculate dose-transition pathways for a CRM study — crm_dtps" />

<meta property="og:description" content="Calculate dose-transition pathways (DTPs, Yap et al, 2017) for a dose-finding
trial using the continual reassessment method (CRM) design. DTPs are a
glimpse into the future for an in-progress trial. They tell us what the model
would advise for all feasible future outcomes. They can be used in the design
stages to detect possible undesirable behaviour. They can be used during the
trial to aid planning and understanding." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trialr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/BEBOP.html">BEBOP in PePS2</a>
    </li>
    <li>
      <a href="../articles/CRM-pathways.html">Dose pathways with CRM</a>
    </li>
    <li>
      <a href="../articles/CRM-visualisation.html">Visualisation with CRM</a>
    </li>
    <li>
      <a href="../articles/CRM.html">Continual Reassessment Method</a>
    </li>
    <li>
      <a href="../articles/EffTox.html">EffTox</a>
    </li>
    <li>
      <a href="../articles/HierarchicalBayesianResponse.html">Hierarchical Bayesian Model for Binary Responses</a>
    </li>
    <li>
      <a href="../articles/LevyCaseStudy.html">CRM Case Study 1 - Levy et al (2006)</a>
    </li>
    <li>
      <a href="../articles/TITE-CRM.html">Time-to-Event Continual Reassessment Method</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/brockk/trialr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate dose-transition pathways for a CRM study</h1>
    <small class="dont-index">Source: <a href='https://github.com/brockk/trialr/blob/master/R/crm_dtps.R'><code>R/crm_dtps.R</code></a></small>
    <div class="hidden name"><code>crm_dtps.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Calculate dose-transition pathways (DTPs, Yap et al, 2017) for a dose-finding
trial using the continual reassessment method (CRM) design. DTPs are a
glimpse into the future for an in-progress trial. They tell us what the model
would advise for all feasible future outcomes. They can be used in the design
stages to detect possible undesirable behaviour. They can be used during the
trial to aid planning and understanding.</p>
    
    </div>

    <pre class="usage"><span class='fu'>crm_dtps</span>(<span class='no'>skeleton</span>, <span class='no'>target</span>, <span class='no'>model</span>, <span class='no'>cohort_sizes</span>, <span class='kw'>previous_outcomes</span> <span class='kw'>=</span> <span class='st'>""</span>,
  <span class='kw'>next_dose</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>user_dose_func</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>i_am_patient</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>skeleton</th>
      <td><p>a vector of the prior guesses of toxicity at doses.
This should be a monotonically-increasing vector of numbers between 0 and 1.</p></td>
    </tr>
    <tr>
      <th>target</th>
      <td><p>the target toxicity probability, a number between 0 and 1.
This value would normally be one of the values in <code>skeleton</code>, but that
is not a requirement.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Character string to denote desired model. One of <code>empiric</code>,
<code>logistic</code>, <code>logistic_gamma</code>, or <code>logistic2</code>.
The choice of model determines which extra parameters are required by
<code>...</code>. See Details.</p></td>
    </tr>
    <tr>
      <th>cohort_sizes</th>
      <td><p>vector of future cohort sizes, i.e. positive integers.
E.g. To calculate paths for the the next cohort of two followed by another
cohort of three, use <code>cohort_sizes = c(2, 3)</code>.</p></td>
    </tr>
    <tr>
      <th>previous_outcomes</th>
      <td><p>Outcomes observed hitherto in the syntax required
by <code><a href='df_parse_outcomes.html'>df_parse_outcomes</a></code>.</p></td>
    </tr>
    <tr>
      <th>next_dose</th>
      <td><p>optional, integer (1-based) dose-level to be given to the
next cohort. If omitted, the dose suggested by the model is used.</p></td>
    </tr>
    <tr>
      <th>user_dose_func</th>
      <td><p>optional delegate for deciding dose. A function that
takes a <code><a href='crm_fit-class.html'>crm_fit</a></code> as the sole argument and returns the integer
(1-based) dose-level to be given next, or NA to show that no dose should be
chosen and the trial stopped. This function gives the user the opportunity to
build in custom behaviour to tailor the dose selection decision in response
to the insights garnered by the fit model, or recommend that a trial path
be halted immediately. If omitted, the dose ordinarily chosen by the model is
used. An example is given below.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical, TRUE to get log messages.</p></td>
    </tr>
    <tr>
      <th>i_am_patient</th>
      <td><p>logical. The number of paths to analyse grows faster than
linearly in the number of future cohorts to resolve. Fitting many models by
MCMC can take a long time. This function will not proceed unless you signify
your patience when the number of paths to reolve exceeds 100.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Extra parameters passed to <code><a href='stan_crm.html'>stan_crm</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>list</code> of <code><a href='dose_finding_path_node-class.html'>dose_finding_path_node</a></code> objects.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Different model choices require that different parameters are provided.
See below.</p>
    
    <h2 class="hasAnchor" id="parameter-requirements-of-empiric-model"><a class="anchor" href="#parameter-requirements-of-empiric-model"></a>Parameter requirements of <code>empiric</code> model</h2>

    
    <ul>
<li><p><code>beta_sd</code></p></li>
</ul>
    
    <h2 class="hasAnchor" id="parameter-requirements-of-logistic-model"><a class="anchor" href="#parameter-requirements-of-logistic-model"></a>Parameter requirements of <code>logistic</code> model</h2>

    
    <ul>
<li><p><code>a0</code></p></li>
<li><p><code>beta_mean</code></p></li>
<li><p><code>beta_sd</code></p></li>
</ul>
    
    <h2 class="hasAnchor" id="parameter-requirements-of-logistic-gamma-model"><a class="anchor" href="#parameter-requirements-of-logistic-gamma-model"></a>Parameter requirements of <code>logistic_gamma</code> model</h2>

    
    <ul>
<li><p><code>a0</code></p></li>
<li><p><code>beta_shape</code></p></li>
<li><p><code>beta_inverse_scale</code></p></li>
</ul>
    
    <h2 class="hasAnchor" id="parameter-requirements-of-logistic-model"><a class="anchor" href="#parameter-requirements-of-logistic-model"></a>Parameter requirements of <code>logistic2</code> model</h2>

    
    <ul>
<li><p><code>alpha_mean</code></p></li>
<li><p><code>alpha_sd</code></p></li>
<li><p><code>beta_mean</code></p></li>
<li><p><code>beta_sd</code></p></li>
</ul>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Yap C, Billingham LJ, Cheung YK, Craddock C, O’Quigley J.
Dose transition pathways: The missing link between complex dose-finding
designs and simple decision-making. Clinical Cancer Research.
2017;23(24):7440-7447. doi:10.1158/1078-0432.CCR-17-0582</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='df_parse_outcomes.html'>df_parse_outcomes</a></code>,
  <code><a href='stan_crm.html'>stan_crm</a></code>,
  <code><a href='crm_path_analysis.html'>crm_path_analysis</a></code>,
  <code><a href='dose_finding_path_node-class.html'>dose_finding_path_node</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='no'>target</span> <span class='kw'>&lt;-</span> <span class='fl'>0.25</span>
<span class='no'>skeleton</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>0.05</span>, <span class='fl'>0.15</span>, <span class='fl'>0.25</span>, <span class='fl'>0.4</span>, <span class='fl'>0.6</span>)

<span class='co'># Run DTPs for the first two cohorts of two for new a trial:</span>
<span class='no'>paths</span> <span class='kw'>&lt;-</span> <span class='fu'>crm_dtps</span>(<span class='kw'>skeleton</span> <span class='kw'>=</span> <span class='no'>skeleton</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='no'>target</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>'empiric'</span>,
                  <span class='kw'>cohort_sizes</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>2</span>, <span class='fl'>2</span>), <span class='kw'>next_dose</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>beta_sd</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='fu'>length</span>(<span class='no'>paths</span>)  <span class='co'># 13</span>

<span class='fu'>library</span>(<span class='no'>tibble</span>)
<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span>(<span class='no'>paths</span>)
<span class='no'>df</span>


<span class='co'># Run DTPs for the next cohort of three in a trial that has already treated</span>
<span class='co'># six patients, seeing some toxicity at dose-level 3:</span>
<span class='no'>paths2</span> <span class='kw'>&lt;-</span> <span class='fu'>crm_dtps</span>(<span class='kw'>skeleton</span> <span class='kw'>=</span> <span class='no'>skeleton</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='no'>target</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>'empiric'</span>,
                   <span class='kw'>cohort_sizes</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>3</span>), <span class='kw'>previous_outcomes</span> <span class='kw'>=</span> <span class='st'>'2NNN 3TTN'</span>,
                   <span class='kw'>beta_sd</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='fu'>length</span>(<span class='no'>paths2</span>)  <span class='co'># 5</span>
<span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span>(<span class='no'>paths2</span>)
<span class='co'># We see that de-escalation to dose-level 2 should occur now, and that any</span>
<span class='co'># further toxicity will result in advice for further de-escalation to</span>
<span class='co'># dose-level 1.</span>


<span class='co'># An example with a custom dose selection function</span>
<span class='no'>paths3</span> <span class='kw'>&lt;-</span> <span class='fu'>crm_dtps</span>(<span class='kw'>skeleton</span> <span class='kw'>=</span> <span class='no'>skeleton</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='no'>target</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>'empiric'</span>,
                   <span class='kw'>cohort_sizes</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>3</span>), <span class='kw'>previous_outcomes</span> <span class='kw'>=</span> <span class='st'>'2NN 3TN'</span>,
                   <span class='kw'>next_dose</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>beta_sd</span> <span class='kw'>=</span> <span class='fl'>1</span>,
                   <span class='kw'>user_dose_func</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) {
                     <span class='fu'><a href='careful_escalation.html'>careful_escalation</a></span>(<span class='no'>x</span>, <span class='kw'>tox_threshold</span> <span class='kw'>=</span> <span class='no'>target</span> + <span class='fl'>0.1</span>,
                                        <span class='kw'>certainty_threshold</span> <span class='kw'>=</span> <span class='fl'>0.7</span>)
                   }, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>123</span>, <span class='kw'>refresh</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='fu'><a href='spread_paths.html'>spread_paths</a></span>(<span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span>(<span class='no'>paths3</span>) <span class='kw'>%&gt;%</span> <span class='fu'>select</span>(-<span class='no'>fit</span>, -<span class='no'>parent_fit</span>, -<span class='no'>dose_index</span>))
<span class='co'># Stopping is recommended when the dose selection function returns NA.</span>
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#parameter-requirements-of-empiric-model">Parameter requirements of <code>empiric</code> model</a></li>

      <li><a href="#parameter-requirements-of-logistic-model">Parameter requirements of <code>logistic</code> model</a></li>

      <li><a href="#parameter-requirements-of-logistic-gamma-model">Parameter requirements of <code>logistic_gamma</code> model</a></li>

      <li><a href="#parameter-requirements-of-logistic-model">Parameter requirements of <code>logistic2</code> model</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Kristian Brock

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kristian Brock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

