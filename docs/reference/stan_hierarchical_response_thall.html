<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit the hierarchical response model described by
Thall <em>et al.</em> (2003). — stan_hierarchical_response_thall • trialr</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fit the hierarchical response model described by
Thall <em>et al.</em> (2003). — stan_hierarchical_response_thall" />

<meta property="og:description" content="Fit the hierarchical response model to exchangeable groups described by
Thall et al. (2003)." />





<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trialr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/BEBOP.html">BEBOP in PePS2</a>
    </li>
    <li>
      <a href="../articles/CRM-pathways.html">Dose pathways with CRM</a>
    </li>
    <li>
      <a href="../articles/CRM-visualisation.html">Visualisation with CRM</a>
    </li>
    <li>
      <a href="../articles/CRM.html">Continual Reassessment Method</a>
    </li>
    <li>
      <a href="../articles/EffTox.html">EffTox</a>
    </li>
    <li>
      <a href="../articles/HierarchicalBayesianResponse.html">Hierarchical Bayesian Model for Binary Responses</a>
    </li>
    <li>
      <a href="../articles/LevyCaseStudy.html">CRM Case Study 1 - Levy et al (2006)</a>
    </li>
    <li>
      <a href="../articles/TITE-CRM.html">Time-to-Event Continual Reassessment Method</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/brockk/trialr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit the hierarchical response model described by
Thall <em>et al.</em> (2003).</h1>
    <small class="dont-index">Source: <a href='https://github.com/brockk/trialr/blob/master/R/stan_hierarchical_response_thall.R'><code>R/stan_hierarchical_response_thall.R</code></a></small>
    <div class="hidden name"><code>stan_hierarchical_response_thall.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fit the hierarchical response model to exchangeable groups described by
Thall <em>et al.</em> (2003).</p>
    
    </div>

    <pre class="usage"><span class='fu'>stan_hierarchical_response_thall</span>(
  <span class='no'>group_responses</span>,
  <span class='no'>group_sizes</span>,
  <span class='no'>mu_mean</span>,
  <span class='no'>mu_sd</span>,
  <span class='no'>tau_alpha</span>,
  <span class='no'>tau_beta</span>,
  <span class='no'>...</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>group_responses</th>
      <td><p>vector of integers, number of responses in each group</p></td>
    </tr>
    <tr>
      <th>group_sizes</th>
      <td><p>vector of integers, number of patients in each group</p></td>
    </tr>
    <tr>
      <th>mu_mean</th>
      <td><p>mean parameter of normal prior distribution on mu. See details.</p></td>
    </tr>
    <tr>
      <th>mu_sd</th>
      <td><p>standard deviation parameter of normal prior distribution on mu.
See details.</p></td>
    </tr>
    <tr>
      <th>tau_alpha</th>
      <td><p>parameter alpha of inverse gamma prior distribution on tau. See
details.</p></td>
    </tr>
    <tr>
      <th>tau_beta</th>
      <td><p>beta parameter of inverse gamma prior distribution on tau. See
details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Extra parameters are passed to <code><a href='https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html'>rstan::sampling</a></code>. Commonly
used options are <code>iter</code>, <code>chains</code>, <code>warmup</code>, <code>cores</code>, and
<code>control</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Object of class <code><a href='https://rdrr.io/pkg/rstan/man/stanfit-class.html'>rstan::stanfit</a></code> returned
by <code><a href='https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html'>rstan::sampling</a></code></p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Thall <em>et al.</em> (2003) describe hierarchical methods for analysing
treatment effects of a common intervention in several sub-types of a disease.
The treatment effects are assumed to be different but exchangeable and
correlated. Observing efficacy in one cohort, for example, increases one's
expectations of efficacy in others.
They demonstrate the hierarchical approach in a trial with binary response
outcomes and in another with time-to-event outcomes.
This function fits their model for binary response outcomes.</p>
<p>Let the probability of response in group \(i\) be \(\pi[i]\) for
\(i = 1,...,N\).
They assume a logistic model so that
\(\theta_{i} = \log{\pi_{i} / (1 - \pi_{i})}\)
is the log-odds of response in group \(i\).
They assume that \(\theta_{i} \sim N(\mu, \sigma^2)\).</p>
<p>The authors implemented their model in BUGS.
As is the convention in BUGS, the authors define normal distributions by a
precision parameter \(\tau\) as opposed to the standard deviation parameter
\(\sigma\) used here. We have re-specified their model to comply with the
Stan convention of using standard deviation. The authors use a normal
prior on \(\mu\), and a gamma prior on \(\tau\), equivalent to
an inverse gamma prior on \(\tau^{-1} = \sigma^2\).</p>
<p>The authors provide WinBUGS code in their publication.
We implement their model here in Stan.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Thall, Wathen, Bekele, Champlin, Baker, and Benjamin. 2003.
“Hierarchical Bayesian approaches to phase II trials in diseases with
multiple subtypes.” Statistics in Medicine 22 (5): 763–80.
https://doi.org/10.1002/sim.1399.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/rstan/man/stanfit-class.html'>rstan::stanfit</a></code>,
  <code><a href='https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html'>rstan::sampling</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Example from p.778 of Thall et al. (2003)</span>
<span class='no'>mod0</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_hierarchical_response_thall</span>(
  <span class='kw'>group_responses</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>0</span>, <span class='fl'>0</span>),
  <span class='kw'>group_sizes</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>2</span> ,<span class='fl'>1</span>, <span class='fl'>7</span>, <span class='fl'>5</span>, <span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
  <span class='kw'>mu_mean</span> <span class='kw'>=</span> -<span class='fl'>1.3863</span>,
  <span class='kw'>mu_sd</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='fl'>1</span> / <span class='fl'>0.1</span>),
  <span class='kw'>tau_alpha</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>tau_beta</span> <span class='kw'>=</span> <span class='fl'>20</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kristian Brock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


