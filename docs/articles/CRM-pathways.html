<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dose pathways with CRM • trialr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dose pathways with CRM">
<meta property="og:description" content="trialr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trialr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BEBOP.html">BEBOP in PePS2</a>
    </li>
    <li>
      <a href="../articles/CRM-pathways.html">Dose pathways with CRM</a>
    </li>
    <li>
      <a href="../articles/CRM-visualisation.html">Visualisation with CRM</a>
    </li>
    <li>
      <a href="../articles/CRM.html">Continual Reassessment Method</a>
    </li>
    <li>
      <a href="../articles/EffTox.html">EffTox</a>
    </li>
    <li>
      <a href="../articles/HierarchicalBayesianResponse.html">Hierarchical Bayesian Model for Binary Responses</a>
    </li>
    <li>
      <a href="../articles/LevyCaseStudy.html">CRM Case Study 1 - Levy et al (2006)</a>
    </li>
    <li>
      <a href="../articles/TITE-CRM.html">Time-to-Event Continual Reassessment Method</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brockk/trialr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="CRM-pathways_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="CRM-pathways_files/viz-1.8.2/viz.js"></script><link href="CRM-pathways_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="CRM-pathways_files/grViz-binding-1.0.5/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dose pathways with CRM</h1>
                        <h4 class="author">Kristian Brock</h4>
            
            <h4 class="date">2020-04-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/brockk/trialr/blob/master/vignettes/CRM-pathways.Rmd"><code>vignettes/CRM-pathways.Rmd</code></a></small>
      <div class="hidden name"><code>CRM-pathways.Rmd</code></div>

    </div>

    
    
<p>In the general <a href="CRM.html">introductory CRM vignette</a>, we introduced the different flavours of the Continual Reassessment Method (CRM) implmented in <code>trialr</code>. In this vignette, we demonstrate some of <code>trialr</code>’s capabilities for analysing dose transition pathways <span class="citation">(Yap et al. 2017)</span> with the general CRM model.</p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>A pathway in a dose-finding trial represents a sequence of doses that were delivered to patients and the outcomes that they experienced. <code>trialr</code> provides functions for calculating pathways, analysing model behaviour, and visualising results.</p>
<p>A syntax for succinctly representing pathways will be useful. <span class="citation">Brock et al. (2017)</span> introduced a method for describing dose pathways in efficacy and toxicity dose-finding trials using the characters E, T, N &amp; B to represent patients that experienced efficacy only, toxicity only, neither or both. This syntax is used in the <a href="EffTox.html">EffTox vignette</a>. In the CRM setting, where patients experience only <em>toxicity</em> or <em>no toxicity</em>, we can restrict the character set to simply T and N.</p>
<p>Thus, a dose-finding trial that treated a cohort of three patients at dose-level 1, with none experiencing the dose-limiting toxicity (DLT) event, may be represented as <code>1NNN</code>. If the next cohort of three was treated at dose-level 2 and the first of these three experienced DLT, we could describe the entire pathway as <code>1NNN 2TNN</code>. Cohorts are assumed to be separated by spaces. This syntax can be used to describe the outcomes observed hitherto in a trial, the notional future outcomes, or some combination of the two.</p>
<p>We might analyse the model fits on a pathway to learn how model estimation has evolved in a trial. That is the topic of the next section. We might also like to investigate what a CRM model would recommend in each feasible future pathway, as described by <span class="citation">Yap et al. (2017)</span>. Used in this way, the analysis of dose transition pathways is a valuable step for honing a trial design, or anticipating future trial directions. This is the topic of the latter section.</p>
</div>
<div id="dose-pathways-with-crm-in-trialr" class="section level2">
<h2 class="hasAnchor">
<a href="#dose-pathways-with-crm-in-trialr" class="anchor"></a>Dose pathways with CRM in <code>trialr</code>
</h2>
<p>Suppose we are mid-way through a dose-finding trial using a CRM design. We have treated and evaluated nine patients at two dose-levels, with one toxicity seen at the second dose:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">outcome_str</span> <span class="kw">&lt;-</span> <span class="st">'1NNN 2NTN 2NNN'</span></pre></body></html></div>
<p>Seeking a dose associated with a risk of toxicity close to 25%, we commenced the trial with the following dose-toxicity skeleton:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">skeleton</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.25</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>)
<span class="no">target</span> <span class="kw">&lt;-</span> <span class="fl">0.25</span></pre></body></html></div>
<p>The <code>crm_path_analysis</code> function provides a convenient way of fitting the CRM model to each cohort in a pathway. This allows us to see how our model has evolved in its inferences.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">trialr</span>)

<span class="no">path</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/crm_path_analysis.html">crm_path_analysis</a></span>(
  <span class="kw">outcome_str</span> <span class="kw">=</span> <span class="no">outcome_str</span>,
  <span class="kw">skeleton</span> <span class="kw">=</span> <span class="no">skeleton</span>, <span class="kw">target</span> <span class="kw">=</span> <span class="no">target</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="st">'empiric'</span>,
  <span class="kw">beta_sd</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123</span>, <span class="kw">refresh</span> <span class="kw">=</span> <span class="fl">0</span>)</pre></body></html></div>
<p>The code above fits four CRM models:</p>
<ul>
<li>using the prior beliefs only, before any patients have been treated (i.e. the pathway is the empty string "")</li>
<li>after outcomes <code>1NNN</code>
</li>
<li>after outcomes <code>1NNN 2NTN</code>
</li>
<li>after outcomes <code>1NNN 2NTN 2NNN</code>
</li>
</ul>
<p>The returned object has type <code>dose_finding_paths</code>, a simple <code>list</code>-like object containing the nodes on the dose pathway. These nodes contain the <code>crm_fit</code> objects that would have been returned by calling <code>stan_crm</code> on the prevailing outcomes. Nodes also contain references to their parent so that the sequence of a pathway is known. This is pertinent below in the analysis of future pathways where many different future outcomes are possible, creating rich tree-like structures.</p>
<p>For all <code>dose_finding_paths</code> objects, the nodes are keyed by the pathway:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">path</span>)</pre></body></html></div>
<pre><code>## [1] ""               "1NNN"           "1NNN 2NTN"      "1NNN 2NTN 2NNN"</code></pre>
<p>We can convert the path object to a <code>tibble</code> for flexible analysis:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tibble</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="no">path</span>)
<span class="no">df</span></pre></body></html></div>
<pre><code>## # A tibble: 4 x 8
##   .node .parent .depth outcomes    next_dose fit      parent_fit dose_index
##   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt; &lt;named &gt; &lt;named li&gt; &lt;named li&gt;
## 1     1      NA      0 ""                  2 &lt;crm_fi… &lt;NULL&gt;     &lt;dbl [5]&gt; 
## 2     2       1      1 "1NNN"              4 &lt;crm_fi… &lt;crm_fit&gt;  &lt;dbl [5]&gt; 
## 3     3       2      2 "1NNN 2NTN"         2 &lt;crm_fi… &lt;crm_fit&gt;  &lt;dbl [5]&gt; 
## 4     4       3      3 "1NNN 2NTN…         3 &lt;crm_fi… &lt;crm_fit&gt;  &lt;dbl [5]&gt;</code></pre>
<p><code>tibble</code> was chosen over the base R <code>data.frame</code> class because of its flexibility. For instance, the <code>fit</code> column contains the <code>crm_fit</code> object associated with the outcomes. The <code>dose_index</code> column contains a vector of integers reflecting the dose-level under study. This is useful if we <code>unnest</code> the data to analyse statistics pertaining to specific doses. For instance, we might be interested in how our beliefs on the rate of toxicity at dose-level 2 have evolved. Using functions from <code>dplyr</code>, <code>tidyr</code> and <code>purrr</code>, we can extract the <code>prob_tox</code> vector from each fit, unnest, and filter to retain only rows that pertain to dose 2.</p>
<p>The behaviour of <code>unnest</code> changed in v1.0 of <code>tidyr</code>. As of version v1.0, the command to do this is:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">purrr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">prob_tox</span> <span class="kw">=</span> <span class="no">fit</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span>(<span class="st">'prob_tox'</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">outcomes</span>, <span class="no">dose_index</span>, <span class="no">prob_tox</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span>(<span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">dose_index</span>, <span class="no">prob_tox</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">dose_index</span> <span class="kw">==</span> <span class="fl">2</span>)</pre></body></html></div>
<pre><code>## # A tibble: 4 x 3
##   outcomes         dose_index prob_tox
##   &lt;chr&gt;                 &lt;dbl&gt;    &lt;dbl&gt;
## 1 ""                        2    0.226
## 2 "1NNN"                    2    0.128
## 3 "1NNN 2NTN"               2    0.232
## 4 "1NNN 2NTN 2NNN"          2    0.168</code></pre>
<p>For older versions of <code>tidyr</code>, that command is:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">purrr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">prob_tox</span> <span class="kw">=</span> <span class="no">fit</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span>(<span class="st">'prob_tox'</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">outcomes</span>, <span class="no">dose_index</span>, <span class="no">prob_tox</span>) <span class="kw">%&gt;%</span>
  <span class="no">unnest</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">dose_index</span> <span class="kw">==</span> <span class="fl">2</span>)</pre></body></html></div>
<p>We see that at each update, the toxicity estimate moves in the direction we would expect in response to the outcomes observed.</p>
<p>Having the <code>crm_fit</code> object available allows us to analyse alternative algorithms for choosing dose. For instance, the <code>careful_escalation</code> function will avoid skipping doses in escalation and halt a trial when there is sufficient evidence that a particular dose is too toxic.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
    <span class="kw">recommended_dose</span> <span class="kw">=</span> <span class="no">fit</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_int</a></span>(<span class="st">'recommended_dose'</span>),
    <span class="kw">careful_dose</span> <span class="kw">=</span> <span class="no">fit</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span>(<span class="no">careful_escalation</span>,
                                   <span class="kw">tox_threshold</span> <span class="kw">=</span> <span class="no">target</span> + <span class="fl">0.1</span>,
                                   <span class="kw">certainty_threshold</span> <span class="kw">=</span> <span class="fl">0.7</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">outcomes</span>, <span class="no">recommended_dose</span>, <span class="no">careful_dose</span>)</pre></body></html></div>
<pre><code>## # A tibble: 4 x 3
##   outcomes         recommended_dose careful_dose
##   &lt;chr&gt;                       &lt;int&gt;        &lt;dbl&gt;
## 1 ""                              2            1
## 2 "1NNN"                          4            2
## 3 "1NNN 2NTN"                     2            2
## 4 "1NNN 2NTN 2NNN"                3            3</code></pre>
<p>We will use dose selection functions like <code>careful_escalation</code> again below when calculating future dose transition pathways. To complete this example, let us observe how <code>careful_escalation</code> will eventually recommended the dose-level <code>NA</code> to signify that the trial should be stopped.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">paths</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/crm_path_analysis.html">crm_path_analysis</a></span>(
  <span class="kw">outcome_str</span> <span class="kw">=</span> <span class="st">'1NNN 2NTN 2NNN 3TTT 1TTT 1TNT'</span>,
  <span class="kw">skeleton</span> <span class="kw">=</span> <span class="no">skeleton</span>, <span class="kw">target</span> <span class="kw">=</span> <span class="no">target</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="st">'logistic'</span>,
  <span class="kw">a0</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">beta_mean</span> <span class="kw">=</span> <span class="fl">0</span>,<span class="kw">beta_sd</span> <span class="kw">=</span> <span class="fl">1</span>,
  <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123</span>, <span class="kw">refresh</span> <span class="kw">=</span> <span class="fl">0</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(<span class="no">paths</span>)

<span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
    <span class="kw">recommended_dose</span> <span class="kw">=</span> <span class="no">fit</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_int</a></span>(<span class="st">'recommended_dose'</span>),
    <span class="kw">careful_dose</span> <span class="kw">=</span> <span class="no">fit</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span>(<span class="no">careful_escalation</span>,
                                   <span class="kw">tox_threshold</span> <span class="kw">=</span> <span class="no">target</span> + <span class="fl">0.1</span>,
                                   <span class="kw">certainty_threshold</span> <span class="kw">=</span> <span class="fl">0.7</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">outcomes</span>, <span class="no">recommended_dose</span>, <span class="no">careful_dose</span>)</pre></body></html></div>
<pre><code>## # A tibble: 7 x 3
##   outcomes                        recommended_dose careful_dose
##   &lt;chr&gt;                                      &lt;int&gt;        &lt;dbl&gt;
## 1 ""                                             1            1
## 2 "1NNN"                                         5            2
## 3 "1NNN 2NTN"                                    2            2
## 4 "1NNN 2NTN 2NNN"                               3            3
## 5 "1NNN 2NTN 2NNN 3TTT"                          1            1
## 6 "1NNN 2NTN 2NNN 3TTT 1TTT"                     1            1
## 7 "1NNN 2NTN 2NNN 3TTT 1TTT 1TNT"                1            1</code></pre>
<p>After these inopportune outcomes, we see that the <code>careful_escalation</code> function now advocates stopping. It does this because there is a greater than 70% posterior probability that the risk of toxicity at the lowest dose-level exceeds the target toxicity rate plus 10%. It stops with reference to toxicity risk at the lowest dose by default. To scrutinise another dose-level, we could have used the <code>reference_dose</code> parameter.</p>
</div>
<div id="dose-transition-pathways-for-future-cohorts" class="section level2">
<h2 class="hasAnchor">
<a href="#dose-transition-pathways-for-future-cohorts" class="anchor"></a>Dose transition pathways for future cohorts</h2>
<p>Statisticians have demonstrated again and again the poor performance of the perennial 3+3 dose-finding design <span class="citation">(O’Quigley, Pepe, and Fisher 1990; Iasonos et al. 2008; Le Tourneau, Lee, and Siu 2009)</span>. Despite this, the approach has remained stubbornly popular for decades <span class="citation">(Rogatko et al. 2007; Chiuzan et al. 2017)</span>. Why is this?</p>
<p>It is surely due in part to 3+3’s simplicity. Dose selection decisions are governed by simple rules based on the outcomes of cohorts of three patients. Once familiar with these rules, perfect foresight on the dose selection pathways is possible. For instance <code>1NNN</code>, will be followed by a cohort at dose 2. <code>1NNT</code> will be followed by another cohort at dose 1. <code>1NNT 1NNN</code> will be followed by a cohort at dose 2. <code>1NNT 1NNN 2NTT</code> will result in the trial being stopped and dose 1 being declared the maximum tolerable dose (MTD). These simple rules can be generalised ad-nauseam to foresee every conceivable trial pathway.</p>
<p>Dose transition pathways (DTPs) are a general tool for furnishing relatively complex statistical dose-finding designs with the same level of foresight and transparency. <span class="citation">Yap et al. (2017)</span> introduced DTPs with the CRM as a tool to aid trial design and planning.</p>
<p>The <code>trialr</code> function <code>crm_dtps</code> calculates DTPs for an arbitrary sequence of future cohorts of your choosing. The function is essentially a sequence of calls to <code>stan_crm</code>, with some logic to record the path structure and avoid redundant invocations. Thus, each of the CRM model types supported by <code>stan_crm</code> is supported here.</p>
<p>To calculate paths for two future cohorts of two patients, we use the parameter <code>cohort_sizes = c(2, 2)</code>:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">paths</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/crm_dtps.html">crm_dtps</a></span>(<span class="kw">skeleton</span> <span class="kw">=</span> <span class="no">skeleton</span>,
                  <span class="kw">target</span> <span class="kw">=</span> <span class="no">target</span>,
                  <span class="kw">model</span> <span class="kw">=</span> <span class="st">'empiric'</span>,
                  <span class="kw">cohort_sizes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>),
                  <span class="kw">next_dose</span> <span class="kw">=</span> <span class="fl">2</span>,
                  <span class="kw">beta_sd</span> <span class="kw">=</span> <span class="fl">1</span>,
                  <span class="kw">refresh</span> <span class="kw">=</span> <span class="fl">0</span>)</pre></body></html></div>
<p>The parameters <code>skeleton</code>, <code>target</code> and <code>model</code> are mandatory because they are passed to <code>stan_crm</code>. Depending on the <code>model</code> type chosen, further parameters will be required. For instance, under the <code>empiric</code> model we must provide a value for the prior standard deviation of <span class="math inline">\(\beta\)</span> via the <code>beta_sd</code> parameter. Refer to the <a href="CRM.html">introductory CRM vignette</a> for more details.</p>
<p>In the example above, the parameter <code>next_dose</code> determines the dose-level that will be given to the first cohort. If omitted, the first cohort is treated at the dose suggested by the model fit only to the prior information. The option of overriding this is provided because in such experimental medical settings, trialists may choose to start at a dose they firmly believe will be safe, even if their prior belief is that some higher doses will also be tolerable.</p>
<p>Further parameters can be passed ultimately to <code><a href="https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html">rstan::sampling</a></code> via the ellipsis operator to tailor the MCMC sampling. Here, we provide <code>refresh = 0</code> to suppress sampling messages. We might also have adjusted the number of <code>cores</code> to use for sampling, or the number of <code>warmup</code> samples, for instance. See the <code>rstan</code> documentation for full details.</p>
<p>As with the examples in the previous section, a <code>dose_finding_paths</code> object is returned that may be converted to a <code>tibble</code> for further analysis.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(<span class="no">paths</span>)
<span class="no">df</span></pre></body></html></div>
<pre><code>## # A tibble: 13 x 8
##    .node .parent .depth outcomes next_dose fit       parent_fit  dose_index
##    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;named l&gt; &lt;named lis&gt; &lt;named li&gt;
##  1     1      NA      0 ""               2 &lt;crm_fit&gt; &lt;NULL&gt;      &lt;dbl [5]&gt; 
##  2     2       1      1 "NN"             4 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
##  3     3       2      2 "NN"             5 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
##  4     4       1      1 "NT"             1 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
##  5     5       4      2 "NN"             2 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
##  6     6       1      1 "TT"             1 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
##  7     7       6      2 "NN"             1 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
##  8     8       2      2 "NT"             3 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
##  9     9       4      2 "NT"             1 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
## 10    10       6      2 "NT"             1 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
## 11    11       2      2 "TT"             2 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
## 12    12       4      2 "TT"             1 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt; 
## 13    13       6      2 "TT"             1 &lt;crm_fit&gt; &lt;crm_fit&gt;   &lt;dbl [5]&gt;</code></pre>
<p>We see that our analysis of <code>cohort_sizes = c(2, 2)</code> has yielded 13 model fits. There is one node of depth 0. This is the trial starting point, where <code>next_dose</code> was provided manually. There are three nodes of depth 1, corresponding to paths <code>2NN</code>, <code>2NT</code> and <code>2TT</code>. Finally there are nine nodes of depth 2.</p>
<p>We may find it helpful to see the data in a wide format:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="../reference/spread_paths.html">spread_paths</a></span>(<span class="no">df</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="no">fit</span>, -<span class="no">parent_fit</span>, -<span class="no">dose_index</span>))</pre></body></html></div>
<pre><code>## # A tibble: 9 x 6
##   outcomes0 next_dose0 outcomes1 next_dose1 outcomes2 next_dose2
##   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
## 1 ""                 2 NN                 4 NN                 5
## 2 ""                 2 NN                 4 NT                 3
## 3 ""                 2 NN                 4 TT                 2
## 4 ""                 2 NT                 1 NN                 2
## 5 ""                 2 NT                 1 NT                 1
## 6 ""                 2 NT                 1 TT                 1
## 7 ""                 2 TT                 1 NN                 1
## 8 ""                 2 TT                 1 NT                 1
## 9 ""                 2 TT                 1 TT                 1</code></pre>
<p>This arranges the paths in rows. Similar columns are output for each node in the path. The column names are suffixed so they can be distinguised from one another. The table above confirms that there are nine ways to traverse these first two cohort of two patients.</p>
<p>The pathways we have calculated thus far were calculated from a blank slate - no patients had yet been treated. Pathways may also be calculated for trials in progress. All that is required is that we specify the trial path already observed using the <code>previous_outcomes</code> parameter. In the following example, we calculate pathways for the next two cohorts of three patients, having observed outcomes <code>2NN 3TN</code>.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">paths2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/crm_dtps.html">crm_dtps</a></span>(<span class="kw">skeleton</span> <span class="kw">=</span> <span class="no">skeleton</span>,
                   <span class="kw">target</span> <span class="kw">=</span> <span class="no">target</span>,
                   <span class="kw">model</span> <span class="kw">=</span> <span class="st">'empiric'</span>,
                   <span class="kw">cohort_sizes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">3</span>),
                   <span class="kw">previous_outcomes</span> <span class="kw">=</span> <span class="st">'2NN 3TN'</span>,
                   <span class="kw">next_dose</span> <span class="kw">=</span> <span class="fl">2</span>,
                   <span class="kw">beta_sd</span> <span class="kw">=</span> <span class="fl">1</span>,
                   <span class="kw">refresh</span> <span class="kw">=</span> <span class="fl">0</span>)</pre></body></html></div>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="../reference/spread_paths.html">spread_paths</a></span>(<span class="fu"><a href="https://tidyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(<span class="no">paths2</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="no">fit</span>, -<span class="no">parent_fit</span>, -<span class="no">dose_index</span>))</pre></body></html></div>
<pre><code>## # A tibble: 16 x 6
##    outcomes0 next_dose0 outcomes1 next_dose1 outcomes2 next_dose2
##    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1 ""                 2 NNN                3 NNN                4
##  2 ""                 2 NNN                3 NNT                3
##  3 ""                 2 NNN                3 NTT                2
##  4 ""                 2 NNN                3 TTT                1
##  5 ""                 2 NNT                2 NNN                3
##  6 ""                 2 NNT                2 NNT                2
##  7 ""                 2 NNT                2 NTT                1
##  8 ""                 2 NNT                2 TTT                1
##  9 ""                 2 NTT                1 NNN                2
## 10 ""                 2 NTT                1 NNT                1
## 11 ""                 2 NTT                1 NTT                1
## 12 ""                 2 NTT                1 TTT                1
## 13 ""                 2 TTT                1 NNN                1
## 14 ""                 2 TTT                1 NNT                1
## 15 ""                 2 TTT                1 NTT                1
## 16 ""                 2 TTT                1 TTT                1</code></pre>
<p>When calculaing pathways, the dose given for the next cohort is that with posterior mean probability of toxicity closest to the target. This is the default behaviour for the CRM model. However, we might wish to tailor the algorithm used to select doses. For instance, we might wish to avoid the skipping of doses in escalation and incorporate a mechanism that advises stopping the trial if excess toxicity is seen. As described above, these behaviours are provided by the <code>careful_escalation</code> function. We provide a custom dose selection function via the <code>user_dose_func</code> parameter:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">paths3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/crm_dtps.html">crm_dtps</a></span>(
  <span class="kw">skeleton</span> <span class="kw">=</span> <span class="no">skeleton</span>,
  <span class="kw">target</span> <span class="kw">=</span> <span class="no">target</span>,
  <span class="kw">model</span> <span class="kw">=</span> <span class="st">'empiric'</span>,
  <span class="kw">cohort_sizes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">3</span>),
  <span class="kw">previous_outcomes</span> <span class="kw">=</span> <span class="st">'2NN 3TN'</span>,
  <span class="kw">next_dose</span> <span class="kw">=</span> <span class="fl">2</span>,
  <span class="kw">beta_sd</span> <span class="kw">=</span> <span class="fl">1</span>,
  <span class="kw">user_dose_func</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) {
    <span class="fu"><a href="../reference/careful_escalation.html">careful_escalation</a></span>(<span class="no">x</span>, <span class="kw">tox_threshold</span> <span class="kw">=</span> <span class="no">target</span> + <span class="fl">0.1</span>,
                       <span class="kw">certainty_threshold</span> <span class="kw">=</span> <span class="fl">0.7</span>)
  },
  <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">123</span>, <span class="kw">refresh</span> <span class="kw">=</span> <span class="fl">0</span>)

<span class="no">df3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(<span class="no">paths3</span>)
<span class="fu"><a href="../reference/spread_paths.html">spread_paths</a></span>(<span class="no">df3</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="no">fit</span>, -<span class="no">parent_fit</span>, -<span class="no">dose_index</span>))</pre></body></html></div>
<pre><code>## # A tibble: 16 x 6
##    outcomes0 next_dose0 outcomes1 next_dose1 outcomes2 next_dose2
##    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1 ""                 2 NNN                3 NNN                4
##  2 ""                 2 NNN                3 NNT                3
##  3 ""                 2 NNN                3 NTT                2
##  4 ""                 2 NNN                3 TTT                2
##  5 ""                 2 NNT                2 NNN                3
##  6 ""                 2 NNT                2 NNT                2
##  7 ""                 2 NNT                2 NTT                1
##  8 ""                 2 NNT                2 TTT                1
##  9 ""                 2 NTT                1 NNN                2
## 10 ""                 2 NTT                1 NNT                1
## 11 ""                 2 NTT                1 NTT                1
## 12 ""                 2 NTT                1 TTT                1
## 13 ""                 2 TTT                1 NNN                1
## 14 ""                 2 TTT                1 NNT                1
## 15 ""                 2 TTT                1 NTT                1
## 16 ""                 2 TTT                1 TTT               NA</code></pre>
<p>We see that the custom dose function yields a single difference compared to <code>paths2</code>. After observing <code>2TTT 1TTT</code>, the custom function stops because <span class="math inline">\(Prob(DLT_1 &gt; 0.35 | X) &gt; 0.7\)</span>, i.e. it is likely that even dose-level 1 exceeds our target level of toxicity.</p>
<p>We use <code>careful_escalation</code> here for illustration. <code>user_dose_func</code> can be any function that takes a <code>crm_fit</code> as its single parameter and returns either an integer dose-level, or <code>NA</code> to signify that the trial should stop.</p>
<p>The analysis of DTPs becomes bewildering as the volume of information grows. A clear method of visualisation is extremely valuable. The <code>DiagrammeR</code> package creates graphs of nodes and edges. This is perfect for visualising tree-like structures like those created by <code>crm_dtps</code>.</p>
<p>To create a graph, <code>DiagrammeR</code> requires a <code>data.frame</code> of nodes and another of edges. The nodes are the shapes in a graph. The edges are the lines that join them. <code>trialr</code> has already given us all of the information we require to define these elements. All that remains is to choose a pleasing colour scheme.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co"># This section of code outputs to the Viewer pane in RStudio</span>
<span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span>(<span class="st">"RSTUDIO"</span>) <span class="kw">==</span> <span class="st">"1"</span>) {

  <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DiagrammeR</span>)

  <span class="no">df3</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">.node</span>,
              <span class="kw">type</span> <span class="kw">=</span> <span class="fl">NA</span>,
              <span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(
                <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">next_dose</span>) ~ <span class="st">'Stop'</span>,
                <span class="fl">TRUE</span> ~ <span class="no">next_dose</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>()),
              <span class="kw">shape</span> <span class="kw">=</span> <span class="st">'circle'</span>,
              <span class="kw">fillcolor</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(
                <span class="no">next_dose</span> <span class="kw">==</span> <span class="fl">1</span> ~ <span class="st">'slategrey'</span>,
                <span class="no">next_dose</span> <span class="kw">==</span> <span class="fl">2</span> ~ <span class="st">'skyblue1'</span>,
                <span class="no">next_dose</span> <span class="kw">==</span> <span class="fl">3</span> ~ <span class="st">'royalblue1'</span>,
                <span class="no">next_dose</span> <span class="kw">==</span> <span class="fl">4</span> ~ <span class="st">'orchid4'</span>,
                <span class="no">next_dose</span> <span class="kw">==</span> <span class="fl">5</span> ~ <span class="st">'royalblue4'</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">next_dose</span>) ~ <span class="st">'red'</span>
              )
    ) <span class="kw">-&gt;</span> <span class="no">ndf</span>

  <span class="no">df3</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">.parent</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="no">.parent</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="no">.node</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="no">outcomes</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rel</span> <span class="kw">=</span> <span class="st">"leading_to"</span>) <span class="kw">-&gt;</span> <span class="no">edf</span>

  <span class="no">graph</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DiagrammeR/man/create_graph.html">create_graph</a></span>(<span class="kw">nodes_df</span> <span class="kw">=</span> <span class="no">ndf</span>, <span class="kw">edges_df</span> <span class="kw">=</span> <span class="no">edf</span>)
  <span class="fu"><a href="https://rdrr.io/pkg/DiagrammeR/man/render_graph.html">render_graph</a></span>(<span class="no">graph</span>)
}</pre></body></html></div>
<div id="htmlwidget-b8d29c450d48113deda9" style="width:576px;height:576px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-b8d29c450d48113deda9">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"2\", shape = \"circle\", fillcolor = \"#87CEFF\", fontcolor = \"#FFFFFF\"] \n  \"2\" [label = \"3\", shape = \"circle\", fillcolor = \"#4876FF\", fontcolor = \"#FFFFFF\"] \n  \"3\" [label = \"4\", shape = \"circle\", fillcolor = \"#8B4789\", fontcolor = \"#FFFFFF\"] \n  \"4\" [label = \"2\", shape = \"circle\", fillcolor = \"#87CEFF\", fontcolor = \"#FFFFFF\"] \n  \"5\" [label = \"3\", shape = \"circle\", fillcolor = \"#4876FF\", fontcolor = \"#FFFFFF\"] \n  \"6\" [label = \"1\", shape = \"circle\", fillcolor = \"#708090\", fontcolor = \"#FFFFFF\"] \n  \"7\" [label = \"2\", shape = \"circle\", fillcolor = \"#87CEFF\", fontcolor = \"#FFFFFF\"] \n  \"8\" [label = \"1\", shape = \"circle\", fillcolor = \"#708090\", fontcolor = \"#FFFFFF\"] \n  \"9\" [label = \"1\", shape = \"circle\", fillcolor = \"#708090\", fontcolor = \"#FFFFFF\"] \n  \"10\" [label = \"3\", shape = \"circle\", fillcolor = \"#4876FF\", fontcolor = \"#FFFFFF\"] \n  \"11\" [label = \"2\", shape = \"circle\", fillcolor = \"#87CEFF\", fontcolor = \"#FFFFFF\"] \n  \"12\" [label = \"1\", shape = \"circle\", fillcolor = \"#708090\", fontcolor = \"#FFFFFF\"] \n  \"13\" [label = \"1\", shape = \"circle\", fillcolor = \"#708090\", fontcolor = \"#FFFFFF\"] \n  \"14\" [label = \"2\", shape = \"circle\", fillcolor = \"#87CEFF\", fontcolor = \"#FFFFFF\"] \n  \"15\" [label = \"1\", shape = \"circle\", fillcolor = \"#708090\", fontcolor = \"#FFFFFF\"] \n  \"16\" [label = \"1\", shape = \"circle\", fillcolor = \"#708090\", fontcolor = \"#FFFFFF\"] \n  \"17\" [label = \"1\", shape = \"circle\", fillcolor = \"#708090\", fontcolor = \"#FFFFFF\"] \n  \"18\" [label = \"2\", shape = \"circle\", fillcolor = \"#87CEFF\", fontcolor = \"#FFFFFF\"] \n  \"19\" [label = \"1\", shape = \"circle\", fillcolor = \"#708090\", fontcolor = \"#FFFFFF\"] \n  \"20\" [label = \"1\", shape = \"circle\", fillcolor = \"#708090\", fontcolor = \"#FFFFFF\"] \n  \"21\" [label = \"Stop\", shape = \"circle\", fillcolor = \"#FF0000\", fontcolor = \"#FFFFFF\"] \n\"1\"->\"2\" [label = \"NNN\"] \n\"2\"->\"3\" [label = \"NNN\"] \n\"1\"->\"4\" [label = \"NNT\"] \n\"4\"->\"5\" [label = \"NNN\"] \n\"1\"->\"6\" [label = \"NTT\"] \n\"6\"->\"7\" [label = \"NNN\"] \n\"1\"->\"8\" [label = \"TTT\"] \n\"8\"->\"9\" [label = \"NNN\"] \n\"2\"->\"10\" [label = \"NNT\"] \n\"4\"->\"11\" [label = \"NNT\"] \n\"6\"->\"12\" [label = \"NNT\"] \n\"8\"->\"13\" [label = \"NNT\"] \n\"2\"->\"14\" [label = \"NTT\"] \n\"4\"->\"15\" [label = \"NTT\"] \n\"6\"->\"16\" [label = \"NTT\"] \n\"8\"->\"17\" [label = \"NTT\"] \n\"2\"->\"18\" [label = \"TTT\"] \n\"4\"->\"19\" [label = \"TTT\"] \n\"6\"->\"20\" [label = \"TTT\"] \n\"8\"->\"21\" [label = \"TTT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Compared to the tabular form above, the graph representation of DTPs is far superior. The central node shows that dose 2 will be given to the next cohort. Displaying the nodes that require stopping in a bold and symbolic colour like red immediately conveys useful information. The only path that will see the model advocate stopping in the next two cohorts is if every patient experiences toxicity.</p>
<p>Using graphs and <code>DiagrammeR</code> to visualise paths is potentially very flexible and powerful. Obviously different colours and shapes may be chosen. The opacity (or <em>alpha</em>) of the nodes and paths may be adjusted by their probability of occurrence so that paths that are less likely appear more feint. Opportunities abound.</p>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<p>That concludes this vignette on the analysis of dose transitions with CRM in <code>trialr</code>. The functions described will help investigators design and conduct high-quality dose-finding clinical trials. Behind the scenes, this package leverages the computational power of <code>rstan</code> to fit its models. The objects returned work nicely with modern <code>tidyverse</code> packages and programming-styles to offer a flexible suite of tools for clinical trialists.</p>
<div id="other-crm-vignettes" class="section level2">
<h2 class="hasAnchor">
<a href="#other-crm-vignettes" class="anchor"></a>Other CRM vignettes</h2>
<p>There are many vignettes illuminating the CRM in <code>trialr</code>:</p>
<ul>
<li><a href="CRM.html">An introduction to CRM in ‘trialr’</a></li>
<li><a href="CRM-visualisation.html">Visualisation in CRM</a></li>
<li><a href="TITE-CRM.html">TITE-CRM</a></li>
<li><a href="CRM-pathways.html">Pathways and stopping in CRM</a></li>
<li><a href="LevyCaseStudy.html">Case study using Levy, et al. (2006)</a></li>
<li>Simulation</li>
</ul>
</div>
</div>
<div id="trialr" class="section level1">
<h1 class="hasAnchor">
<a href="#trialr" class="anchor"></a>trialr</h1>
<p><code>trialr</code> is available at <a href="https://github.com/brockk/trialr" class="uri">https://github.com/brockk/trialr</a> and <a href="https://CRAN.R-project.org/package=trialr" class="uri">https://CRAN.R-project.org/package=trialr</a></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Brock2017a">
<p>Brock, Kristian, Lucinda Billingham, Mhairi Copland, Shamyla Siddique, Mirjana Sirovica, and Christina Yap. 2017. “Implementing the EffTox Dose-Finding Design in the Matchpoint Trial.” <em>BMC Medical Research Methodology</em> 17 (1): 112. <a href="https://doi.org/10.1186/s12874-017-0381-x">https://doi.org/10.1186/s12874-017-0381-x</a>.</p>
</div>
<div id="ref-Chiuzan2017">
<p>Chiuzan, Cody, Jonathan Shtaynberger, Gulam A. Manji, Jimmy K. Duong, Gary K. Schwartz, Anastasia Ivanova, and Shing M. Lee. 2017. “Dose-Finding Designs for Trials of Molecularly Targeted Agents and Immunotherapies.” <em>Journal of Biopharmaceutical Statistics</em> 27 (3): 477–94. <a href="https://doi.org/10.1080/10543406.2017.1289952">https://doi.org/10.1080/10543406.2017.1289952</a>.</p>
</div>
<div id="ref-Iasonos2008">
<p>Iasonos, Alexia, Andrew S Wilton, Elyn R Riedel, Venkatraman E Seshan, and David R Spriggs. 2008. “A Comprehensive Comparison of the Continual Reassessment Method to the Standard 3 + 3 Dose Escalation Scheme in Phase I Dose-Finding Studies.” <em>Clinical Trials (London, England)</em> 5 (5): 465–77. <a href="https://doi.org/10.1177/1740774508096474">https://doi.org/10.1177/1740774508096474</a>.</p>
</div>
<div id="ref-LeTourneau2009">
<p>Le Tourneau, Christophe, J. Jack Lee, and Lillian L. Siu. 2009. “Dose Escalation Methods in Phase I Cancer Clinical Trials.” <em>Journal of the National Cancer Institute</em> 101 (10): 708–20. <a href="https://doi.org/10.1093/jnci/djp079">https://doi.org/10.1093/jnci/djp079</a>.</p>
</div>
<div id="ref-OQuigley1990">
<p>O’Quigley, J, M Pepe, and L Fisher. 1990. “Continual Reassessment Method: A Practical Design for Phase 1 Clinical Trials in Cancer.” <em>Biometrics</em> 46 (1): 33–48. <a href="https://doi.org/10.2307/2531628">https://doi.org/10.2307/2531628</a>.</p>
</div>
<div id="ref-Rogatko2007">
<p>Rogatko, André, David Schoeneck, William Jonas, Mourad Tighiouart, Fadlo R. Khuri, and Alan Porter. 2007. “Translation of Innovative Designs into Phase I Trials.” <em>Journal of Clinical Oncology</em> 25 (31): 4982–6. <a href="https://doi.org/10.1200/JCO.2007.12.1012">https://doi.org/10.1200/JCO.2007.12.1012</a>.</p>
</div>
<div id="ref-Yap2017">
<p>Yap, Christina, Lucinda J. Billingham, Ying Kuen Cheung, Charlie Craddock, and John O’Quigley. 2017. “Dose Transition Pathways: The Missing Link Between Complex Dose-Finding Designs and Simple Decision-Making.” <em>Clinical Cancer Research</em> 23 (24): 7440–7. <a href="https://doi.org/10.1158/1078-0432.CCR-17-0582">https://doi.org/10.1158/1078-0432.CCR-17-0582</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kristian Brock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
